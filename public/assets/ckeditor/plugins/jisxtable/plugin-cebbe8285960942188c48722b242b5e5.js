CKEDITOR.plugins.add("jisxtable",{requires:"dialog",lang:"ja,en",icons:"jisxtable",hidpi:!0,init:function(e){function a(e){return CKEDITOR.tools.extend(e||{},{contextSensitive:1,refresh:function(e,a){this.setState(a.contains("table",1)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)}})}if(!e.blockless){var t=(CKEDITOR.plugins.table,e.lang.table);e.addCommand("jisxtable",new CKEDITOR.dialogCommand("jisxtable",{context:"table",allowedContent:"table{width,height}[align,border,cellpadding,cellspacing,summary];caption tbody thead tfoot;th td tr[scope];"+(e.plugins.dialogadvtab?"table"+e.plugins.dialogadvtab.allowedContent():""),requiredContent:"table",contentTransformations:[["table{width}: sizeToStyle","table[width]: sizeToAttribute"]]})),e.addCommand("jisxtableProperties",new CKEDITOR.dialogCommand("jisxtableProperties",a())),e.addCommand("jisxtableHeaderId",new CKEDITOR.dialogCommand("jisxtableHeaderId",a())),e.addCommand("jisxtableDataHeaders",new CKEDITOR.dialogCommand("jisxtableDataHeaders",a())),e.addCommand("jisxtableDelete",a({exec:function(e){var a=e.elementPath(),t=a.contains("table",1);if(t){var l=t.getParent();1!=l.getChildCount()||l.is("body","td","th")||(t=l);var i=e.createRange();i.moveToPosition(t,CKEDITOR.POSITION_BEFORE_START),t.remove(),i.select()}}})),e.ui.addButton&&e.ui.addButton("jisxtable",{label:t.toolbar,command:"jisxtable",toolbar:"insert,30"}),CKEDITOR.dialog.add("jisxtable",this.path+"dialogs/table.js"),CKEDITOR.dialog.add("jisxtableProperties",this.path+"dialogs/table.js"),CKEDITOR.dialog.add("jisxtableHeaderId",this.path+"dialogs/table.js"),CKEDITOR.dialog.add("jisxtableDataHeaders",this.path+"dialogs/table.js"),e.addMenuItems&&e.addMenuItems({jisxtable:{label:t.menu,command:"jisxtableProperties",group:"table",order:5},jisxtableHeaderId:{label:"\u898b\u51fa\u3057\u306e\u8a2d\u5b9a",command:"jisxtableHeaderId",group:"table",order:6},jisxtableDataHeaders:{label:"\u898b\u51fa\u3057\u3092\u6307\u5b9a",command:"jisxtableDataHeaders",group:"table",order:7},jisxtableDelete:{label:t.deleteTable,command:"jisxtableDelete",group:"table",order:1}}),e.on("doubleclick",function(e){e.data.element.is("table")&&(e.data.dialog="jisxtableProperties")}),e.contextMenu&&e.contextMenu.addListener(function(){var a=e.elementPath(),t=a.contains("td",1),l=a.contains("th",1);return menu=l?{jisxtableDelete:CKEDITOR.TRISTATE_OFF,jisxtableHeaderId:CKEDITOR.TRISTATE_OFF,jisxtable:CKEDITOR.TRISTATE_OFF}:t?{jisxtableDelete:CKEDITOR.TRISTATE_OFF,jisxtableDataHeaders:CKEDITOR.TRISTATE_OFF,jisxtable:CKEDITOR.TRISTATE_OFF}:{jisxtableDelete:CKEDITOR.TRISTATE_OFF,jisxtable:CKEDITOR.TRISTATE_OFF},menu})}}});