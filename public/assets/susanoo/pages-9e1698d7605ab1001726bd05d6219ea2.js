(function(){var e,t,n,a=function(e,t){return function(){return e.apply(t,arguments)}};t=function(){function e(){this.init=a(this.init,this)}return e.prototype.init=function(e){$("#treeview").fancytree({source:e,activate:function(e,t){var n;if(n=t.node,!n.data.no_permission)return $.get("/susanoo/pages/select",{genre_id:n.data.id})},lazyload:function(e,t){var n;return n=t.node,t.result={url:"/susanoo/genres/treeview",data:{id:n.data.id}}}}),$(document).on("submit",".form-search",function(){return $.isLoading({text:"\u691c\u7d22\u4e2d"}),!0}),$(document).on("click",".pagination a",function(){return $.isLoading({text:"\u8aad\u8fbc\u4e2d"}),!0}),$(document).on("click","a.sort",function(){return $.isLoading({text:"\u8aad\u8fbc\u4e2d"}),!0})},e}(),e=function(){function e(){this.init=a(this.init,this)}return e.prototype.selected_genre=null,e.prototype.button_folder_select=$("#button-folder-select"),e.prototype.selected_page_content=null,e.prototype.init=function(){var e,t;$(this.button_folder_select).click(function(e){return function(){e.selected_genre&&($("#page_genre_id").val(e.selected_genre.id),$("#selected-genre-name").html(e.selected_genre.title)),$("#modal-folder-select").modal("hide")}}(this)).attr("disabled",!0),$("#link-template-preview").click(function(){var e,t;return e=$("#page_template_id").val(),e&&(t="/susanoo/visitors/preview_virtual",window.open(t+"?mode=template&template_id="+e,"","toolbar=yes,status=no,menubar=yes,scrollbars=yes,resizable")),!1}),e="/susanoo/genres/treeview",$("#treeview").fancytree({source:$.ajax({url:e}),activate:function(e){return function(t,n){var a;return a=n.node,a.data.no_permission?(e.selected_genre={},$(e.button_folder_select).attr("disabled",!0)):(e.selected_genre={id:a.data.id,title:a.title},$(e.button_folder_select).attr("disabled",!1)),e.selected_genre}}(this),lazyload:function(t,n){var a;return a=n.node,n.result={url:e,data:{id:a.data.id}}}}),t="/susanoo/genres/treeview_with_pages",$("#treeview_with_page").fancytree({autoActivate:!1,source:$.ajax({url:t}),activate:function(e){return function(t,n){var a;return a=n.node,a.folder?$.ajax({url:"/susanoo/pages/select_copy_page"}):(e.selected_page_content={title:a.title},$.ajax({url:"/susanoo/pages/select_copy_page?id="+a.data.id})),e.selected_page_content}}(this),lazyload:function(e,n){var a;return a=n.node,n.result={url:t,data:{id:a.data.id}}}}),$(document).on("click","input[name='status']",function(e){return function(t){var n,a;return $("#button-page-preview").attr("disabled",!1),$("#button-page-select").attr("disabled",!1),n=$(t.target).attr("value"),$("#button-page-preview").attr("href","/susanoo/visitors/"+n+"/preview"),$("#button-page-select").attr("value",n),a=e.selected_page_content.title,"unpublished"===$(t.target).attr("name")?a+="\uff08\u975e\u516c\u958b\u30da\u30fc\u30b8\uff09":a+="\uff08\u516c\u958b\u30da\u30fc\u30b8\uff09",e.selected_page_content={title:a,id:n}}}(this)),$(document).on("click","#button-page-select",function(e){return function(){e.selected_page_content&&($("#page_copy_id").attr("value",e.selected_page_content.id),$("#selected-page-name").html(e.selected_page_content.title)),$("#modal-page-select").modal("hide")}}(this)).attr("disabled",!0),$(document).on("click","#button-page-cancel",function(){return function(){$("#page_copy_id").attr("value",""),$("#selected-page-name").html("\u65e2\u5b58\u30da\u30fc\u30b8\u306e\u5185\u5bb9\u3092\u8907\u88fd\u3057\u3066\u65b0\u898f\u306b\u30da\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u5834\u5408\u306f\u3001\u30da\u30fc\u30b8\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044."),$("#modal-page-select").modal("hide")}}()).attr("disabled",!0)},e}(),this.Susanoo||(this.Susanoo={}),(n=this.Susanoo).Page||(n.Page={}),this.Susanoo.ExploreTimer=!1,this.Susanoo.Page.Index=new t,this.Susanoo.Page.Form=new e}).call(this);